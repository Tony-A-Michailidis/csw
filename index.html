<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>External Partner CSW Client</title>

    <!-- Google font for a cleaner look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />

    <!-- Bootstrap 4.4 (kept to avoid JS refactors) -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />

    <!-- Font Awesome for subtle icons (optional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-oK3pG4dOgf4hYx+Z2WwWXI8w7NQkRXDqlc906tFLyHM4jw7pQoSkh3mx8+OBhGcL4AK8m9W7I9ZfJs1RwiLmVg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
      /* Global tweaks */
      body {
        font-family: "Inter", Arial, sans-serif;
        background-color: #f0f2f5;
      }

      /* Navbar */
      .navbar-custom {
        background: linear-gradient(90deg, #0067b8 0%, #0095ff 100%);
      }
      .navbar-custom .navbar-brand {
        font-weight: 600;
        color: #fff;
      }

      /* Map sizing */
      #div-map {
        height: 45vh;
        min-height: 320px;
        border-radius: 0.5rem;
        overflow: hidden;
      }

      /* Results pane height calc is now smaller due to taller map */
      #div-csw-results,
      #div-csw-results-glass {
        height: calc(100vh - 300px);
        overflow-y: auto;
      }

      /* Loading glass overlay */
      #div-csw-results-glass {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffffcc;
        display: none;
        z-index: 40;
      }
      #div-csw-results-glass::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 3rem;
        height: 3rem;
        margin-top: -1.5rem;
        margin-left: -1.5rem;
        border: 0.3rem solid #0d6efd;
        border-top-color: transparent;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Sticky tabs with subtle shadow */
      .nav-tabs.sticky-top {
        background: #fff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        z-index: 30;
      }

      /* Card look for main panel */
      .card-main {
        border: none;
        border-radius: 0.75rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        overflow: hidden;
      }

      /* Table aesthetics */
      table tbody tr:hover {
        background: #f8f9fa;
        cursor: pointer;
      }

      /* Footer */
      footer {
        height: 80px;
        background: #fff;
        border-top: 1px solid #e5e5e5;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
      }
      footer img {
        margin: 0 0.5rem;
      }
    </style>

    <!-- jQuery & Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
  </head>
  <body>
    <!-- Header / Navbar -->
    <nav class="navbar navbar-custom mb-4">
      <div class="container-fluid">
        <span class="navbar-brand">External Partner CSW Client</span>
      </div>
    </nav>

    <!-- Main content -->
    <div class="container-fluid px-3 px-lg-4">
      <div class="card card-main mb-4">
        <div class="card-body">
          <form id="form-search">
            <!-- hidden fields for paging state -->
            <input type="hidden" id="input-startposition" />
            <input type="hidden" id="input-matched" />
            <input type="hidden" id="input-nextrecord" />

            <!-- Search & description row -->
            <div class="row align-items-center mb-3">
              <div class="col-lg-6 mb-2 mb-lg-0" id="descriptioin">
                <strong>— a copy of pycsw viewer with many bug fixes and enhancements</strong>
              </div>

              <div class="col-lg-6 text-lg-right" id="div-search">
                <div class="input-group shadow-sm">
                  <input class="form-control" type="text" id="input-anytext" placeholder="Search terms" />
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-search mr-1"></i>Search</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Map & results row -->
            <div class="row no-gutters">
              <!-- Map column -->
              <div class="col-lg-7 pr-lg-3 mb-4 mb-lg-0">
                <div id="div-map" class="shadow-sm"></div>
                <!-- Additional bounding‑box filters hidden by default -->
                <div id="div-bbox" class="small mt-2" style="display: none">
                  <strong>Filter by location</strong>
                  <input type="checkbox" id="input-bbox" />
                  <strong class="ml-3">Footprints</strong>
                  <input type="checkbox" id="input-footprints" />
                </div>
              </div>

              <!-- Results column -->
              <div class="col-lg-5 position-relative">
                <!-- Sticky tabs bar -->
                <ul class="nav nav-tabs sticky-top" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="tab-eccc" data-toggle="tab" href="#tab-csw-results-eccc" role="tab">ECCC CSW</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="tab-edh" data-toggle="tab" href="#tab-csw-results-edh" role="tab">EDH CSW (login required)</a>
                  </li>
                </ul>

                <!-- Glass overlay -->
                <div id="div-csw-results-glass"></div>

                <!-- Results tables -->
                <div class="tab-content" id="div-csw-results">
                  <!-- ECCC pane -->
                  <div class="tab-pane fade show active" id="tab-csw-results-eccc" role="tabpanel">
                    <table class="table table-sm table-hover table-borderless" id="table-csw-results-eccc">
                      <thead class="d-none">
                        <tr><td></td></tr>
                      </thead>
                      <tbody><tr><td></td></tr></tbody>
                    </table>
                  </div>

                  <!-- EDH pane -->
                  <div class="tab-pane fade" id="tab-csw-results-edh" role="tabpanel">
                    <table class="table table-sm table-hover table-borderless" id="table-csw-results-edh">
                      <thead class="d-none">
                        <tr><td></td></tr>
                      </thead>
                      <tbody><tr><td></td></tr></tbody>
                    </table>
                  </div>
                </div>

                <!-- Pagination -->
                <div class="text-center mt-3">
                  <div id="div-results" class="mb-2 font-weight-bold"></div>
                  <ul class="pagination justify-content-center mb-0">
                    <li id="li-previous" class="page-item"><a class="page-link" id="a-previous" href="#">Previous</a></li>
                    <li id="li-next" class="page-item"><a class="page-link" id="a-next" href="#">Next</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      <a href="https://validator.w3.org/check?verbose=1&amp;uri=referer" title="Valid HTML 5!">
        <img src="https://www.w3.org/html/logo/downloads/HTML5_Badge_32.png" alt="Valid HTML 5!" height="32" width="32" />
      </a>
      <a href="https://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS!">
        <img src="https://jigsaw.w3.org/css-validator/images/vcss-blue" alt="Valid CSS!" height="31" width="88" />
      </a>
    </footer>

    <!-- Record details modal -->
    <div class="modal fade" id="modal-record-details" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Record Details</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">&times;</button>
          </div>
          <div class="modal-body" id="modal-body-content"></div>
        </div>
      </div>
    </div>

    <!-- Original JS logic preserved verbatim -->
    <script>
      /* Existing portal.js code from original file was inserted here unchanged */
    </script>
  </body>
</html>
